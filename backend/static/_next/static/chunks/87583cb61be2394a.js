(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,23261,e=>{"use strict";e.s(["default",()=>A],23261);var t=e.i(43476),a=e.i(71645),s=e.i(70065),n=e.i(67881),r=e.i(84762),c=e.i(81140),i=e.i(20783),l=e.i(30030),d=e.i(69340),o=e.i(35804),m=e.i(48425),u="Switch",[h,x]=(0,l.createContextScope)(u),[p,f]=h(u),g=a.forwardRef((e,s)=>{let{__scopeSwitch:n,name:r,checked:l,defaultChecked:o,required:h,disabled:x,value:f="on",onCheckedChange:g,form:b,...j}=e,[N,_]=a.useState(null),y=(0,i.useComposedRefs)(s,e=>_(e)),w=a.useRef(!1),C=!N||b||!!N.closest("form"),[S,T]=(0,d.useControllableState)({prop:l,defaultProp:null!=o&&o,onChange:g,caller:u});return(0,t.jsxs)(p,{scope:n,checked:S,disabled:x,children:[(0,t.jsx)(m.Primitive.button,{type:"button",role:"switch","aria-checked":S,"aria-required":h,"data-state":k(S),"data-disabled":x?"":void 0,disabled:x,value:f,...j,ref:y,onClick:(0,c.composeEventHandlers)(e.onClick,e=>{T(e=>!e),C&&(w.current=e.isPropagationStopped(),w.current||e.stopPropagation())})}),C&&(0,t.jsx)(v,{control:N,bubbles:!w.current,name:r,value:f,checked:S,required:h,disabled:x,form:b,style:{transform:"translateX(-100%)"}})]})});g.displayName=u;var b="SwitchThumb",j=a.forwardRef((e,a)=>{let{__scopeSwitch:s,...n}=e,r=f(b,s);return(0,t.jsx)(m.Primitive.span,{"data-state":k(r.checked),"data-disabled":r.disabled?"":void 0,...n,ref:a})});j.displayName=b;var v=a.forwardRef((e,s)=>{let{__scopeSwitch:n,control:r,checked:c,bubbles:l=!0,...d}=e,m=a.useRef(null),u=(0,i.useComposedRefs)(m,s),h=function(e){let t=a.useRef({value:e,previous:e});return a.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}(c),x=(0,o.useSize)(r);return a.useEffect(()=>{let e=m.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(h!==c&&t){let a=new Event("click",{bubbles:l});t.call(e,c),e.dispatchEvent(a)}},[h,c,l]),(0,t.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:c,...d,tabIndex:-1,ref:u,style:{...d.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function k(e){return e?"checked":"unchecked"}v.displayName="SwitchBubbleInput";var N=e.i(47163);function _(e){let{className:a,...s}=e;return(0,t.jsx)(g,{"data-slot":"switch",className:(0,N.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...s,children:(0,t.jsx)(j,{"data-slot":"switch-thumb",className:(0,N.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}var y=e.i(71435),w=e.i(62198),C=e.i(54858),S=e.i(14764);let T=(0,e.i(75254).default)("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);function A(){let[e,c]=(0,a.useState)([]),[i,l]=(0,a.useState)(null),[d,o]=(0,a.useState)([]),[m,u]=(0,a.useState)(""),[h,x]=(0,a.useState)(!1),[p,f]=(0,a.useState)("gemini"),g=(0,a.useRef)(null);(0,a.useEffect)(()=>{let e=(0,w.getSocket)();return e.connect(),b(),j(),e.on("admin_connected",e=>{o(e.history||[]),e.chat&&x(e.chat.is_human_enabled)}),e.on("new_message",e=>{e.chat_id===i&&o(t=>[...t,e])}),e.on("human_enabled_changed",e=>{e.chat_id===i&&x(e.is_human_enabled),c(t=>t.map(t=>t.id===e.chat_id?{...t,is_human_enabled:e.is_human_enabled}:t))}),()=>{i&&e.emit("admin_disconnect_from_chat",{chat_id:i}),e.off("admin_connected"),e.off("new_message"),e.off("human_enabled_changed")}},[i]),(0,a.useEffect)(()=>{var e;null==(e=g.current)||e.scrollIntoView({behavior:"smooth"})},[d]);let b=async()=>{let e=await C.api.getAllChats();e.success&&c(e.chats)},j=async()=>{let e=await C.api.getCurrentModel();e.success&&f(e.model)},v=()=>{m.trim()&&i&&h&&((0,w.getSocket)().emit("admin_message",{chat_id:i,message:m}),u(""))},k=async e=>{let t=e?"openai":"gemini";(await C.api.setModel(t)).success&&f(t)};return(0,t.jsxs)("div",{className:"flex h-full",children:[(0,t.jsxs)("div",{className:"flex-1 flex flex-col p-4",children:[(0,t.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Admin Dashboard"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Monitor and intervene in student chats"})]}),(0,t.jsx)(s.Card,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(T,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Gemini 2.5 Pro"}),(0,t.jsx)(_,{checked:"openai"===p,onCheckedChange:k}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"GPT-4o"})]})})]}),i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Card,{className:"mb-4 p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:"Human Intervention"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Toggle to disable AI and take over the conversation"})]}),(0,t.jsx)(_,{checked:h,onCheckedChange:e=>{i&&(0,w.getSocket)().emit("toggle_human_enabled",{chat_id:i,is_enabled:e})}})]})}),(0,t.jsx)(y.ScrollArea,{className:"flex-1 mb-4 h-[calc(100vh-350px)]",children:(0,t.jsxs)("div",{className:"space-y-4 pr-4",children:[d.map((e,a)=>{var n,r;return(0,t.jsx)(s.Card,{className:"max-w-[80%] ".concat("human"===(n=e.role)?"bg-blue-100 dark:bg-blue-900 ml-auto":"ai"===n?"bg-gray-100 dark:bg-gray-800 mr-auto":"human_operator"===n?"bg-green-100 dark:bg-green-900 ml-auto":""),children:(0,t.jsxs)(s.CardContent,{className:"p-3",children:[(0,t.jsx)("p",{className:"text-xs font-semibold mb-1",children:"human"===(r=e.role)?"Student":"ai"===r?"AI Assistant":"human_operator"===r?"You (Admin)":r}),(0,t.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.message}),e.created_at&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(e.created_at).toLocaleTimeString()})]})},a)}),(0,t.jsx)("div",{ref:g})]})}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(r.Textarea,{value:m,onChange:e=>u(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),v())},placeholder:h?"Type your message...":"Enable human intervention to send messages",disabled:!h,className:"flex-1 min-h-[60px] max-h-[120px]"}),(0,t.jsx)(n.Button,{onClick:v,disabled:!h,size:"icon",className:"h-[60px] w-[60px]",children:(0,t.jsx)(S.Send,{className:"h-5 w-5"})})]})]}):(0,t.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,t.jsx)(s.Card,{className:"p-8 text-center",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"Select a chat to monitor or intervene"})})})]}),(0,t.jsxs)("div",{className:"w-80 border-l p-4",children:[(0,t.jsx)(s.CardHeader,{className:"px-0 pt-0",children:(0,t.jsx)(s.CardTitle,{children:"All Chats"})}),(0,t.jsx)(y.ScrollArea,{className:"h-[calc(100vh-120px)]",children:(0,t.jsxs)("div",{className:"space-y-2",children:[e.map(e=>(0,t.jsx)(s.Card,{className:"cursor-pointer hover:bg-accent transition-colors ".concat(i===e.id?"border-primary":""),onClick:()=>(e=>{let t=(0,w.getSocket)();i&&t.emit("admin_disconnect_from_chat",{chat_id:i}),l(e),t.emit("admin_connect",{chat_id:e})})(e.id),children:(0,t.jsxs)(s.CardContent,{className:"p-3",children:[(0,t.jsxs)("p",{className:"font-medium",children:["Chat #",e.id]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(e.created_at).toLocaleString()}),e.is_human_enabled&&(0,t.jsx)("p",{className:"text-xs text-green-600 dark:text-green-400 mt-1 font-medium",children:"âœ“ Human intervention active"})]})},e.id)),0===e.length&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No chats yet"})]})})]})]})}}]);